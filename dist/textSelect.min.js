/*! $.textSelect - v0.5.0 - 2013-02-13
* https://github.com/JamesMGreene/jquery.textSelect
* Copyright (c) 2013 James M. Greene; Licensed MIT */
(function(e,t){"use strict";var n=t.document,o=t.console||null,a=e(n),i=0,l={},r=".textSelect",s=r+".default";e.event.special.textSelect={add:function(t){0===i++&&a.on("mouseup"+s,function(){o&&"function"==typeof o.log&&o.log("document.mouseup [Final bubble! No additional handlers will be invoked]"),l={}});var n=r+(t.namespace?"."+t.namespace:""),c=t.selector,u=e(this);u.on("mousedown"+n,c,function(e){l[this]=e}),u.on("mouseup"+n,c,function(n){var o=e.event.special.textSelect.behaviors;if(l[this]&&o.getSelectedText()){var a,i=l[this],r=n.type,s=n.relatedTarget,c=n.data;l={},n.type=t.origType,n.relatedTarget=i.target,a=o.getCustomEventData(n),t.data=e.extend(!0,{},c,t.data,a),e.event.dispatch.apply(this,arguments),n.type=r,n.relatedTarget=s,n.data=c}})},remove:function(t){0===--i&&a.off(s);var n=r+(t.namespace?"."+t.namespace:""),o=t.selector,l=e(this);l.off("mousedown"+n,o),l.off("mouseup"+n,o)},trigger:function(){var t=e(this);return t.trigger("mousedown"),e.event.special.textSelect.behaviors.selectText(this),t.trigger("mouseup"),!1},options:{getSelectedText:function(){var e="";if(t.getSelection){var o,a=t.getSelection(),i=[];for(o=0;a.rangeCount>o;o++)i.push(""+a.getRangeAt(o));e=i.join("")}else n.selection&&(e=n.selection.createRange().text);return e},getSelectedHtml:function(){var o="";if(t.getSelection){var a,i,l=t.getSelection(),r=e("<div></div>"),s=[],c=function(){return""===e.trim(e(this).html())};for(i=0;l.rangeCount>i;i++)a=r.empty().append(l.getRangeAt(i).cloneContents()),a.filter(c).remove(),s.push(a.html());o=s.join("")}else n.selection&&(o=n.selection.createRange().htmlText);return o},selectText:function(o){var a;if(t.getSelection){var i="undefined"!=typeof Node?Node.TEXT_NODE:3,l=e(o).contents().filter(function(){return this.nodeType===i}),r=l.first().get(0),s=l.last().get(0),c=t.getSelection();c.rangeCount>0&&c.removeAllRanges(),a=n.createRange(),a.setStart(r,0),a.setEnd(s,s.nodeValue.length),c.addRange(a)}else n.selection&&(n.selection.empty(),a=o.createTextRange(),a.select())},getCustomEventData:function(){var t=e.event.special.textSelect.options.getSelectedText(),n=e.event.special.textSelect.options.getSelectedHtml();return{text:t,html:n}}}}})(jQuery,this);